@model IEnumerable<LearningApplicantWeb.Models.EF.Applicant>

@{
    ViewData["Title"] = "List Applicant";
}

<h1>Daftar Pelamar</h1>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Nama Lengkap</th>
            <th>Posisi Dilamar</th>
            <th>NIK</th>
            <th>Nomor Telepon</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>@Html.DisplayFor(modelItem => item.FirstName) @Html.DisplayFor(modelItem => item.LastName)</td>
            <td>@(item.Position?.PositionName?? "N/A")</td>
            <td>@Html.DisplayFor(modelItem => item.Nik)</td>
            <td>@Html.DisplayFor(modelItem => item.Phone)</td>
            <td>
                    <a asp-action="Update" asp-route-id="@item.ApplicantId" class="btn btn-sm btn-warning">Ubah</a>
                
                    <button type="button" class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#destroyModal" data-id="@item.ApplicantId" data-name="@item.FirstName @item.LastName">
                        Hapus
                    </button>
            </td>
        </tr>
}
    </tbody>
</table>

@await Html.PartialAsync("DestroyModal")

@section Scripts {
    <script>
        var destroyModal = document.getElementById('destroyModal');
        if(destroyModal) {
            destroyModal.addEventListener('show.bs.modal', function (event) {
                var button = event.relatedTarget;
                var applicantId = button.getAttribute('data-id');
                var applicantName = button.getAttribute('data-name');

                var modalBody = destroyModal.querySelector('.modal-body');
                var form = destroyModal.querySelector('#destroyForm');
                
                modalBody.textContent = 'Apakah Anda yakin ingin menghapus data pelamar: ' + applicantName + '?';
                form.action = '/Applicant/Destroy/' + applicantId;
            });
        }
    </script>
}